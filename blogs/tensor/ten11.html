<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TensorFlow笔记（11） | 周清冽</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="false">
    <script>
          var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?b0aae218897fa9d8a9f76e9a77e0b3c6";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
          })();
        </script>
    <meta name="description" content="记录我的生活">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.46b311ed.css" as="style"><link rel="preload" href="/assets/js/app.d0fa7b20.js" as="script"><link rel="preload" href="/assets/js/5.3a253b5d.js" as="script"><link rel="preload" href="/assets/js/1.cc71daf5.js" as="script"><link rel="preload" href="/assets/js/38.cbe48101.js" as="script"><link rel="prefetch" href="/assets/js/10.fa7958e2.js"><link rel="prefetch" href="/assets/js/11.db34a267.js"><link rel="prefetch" href="/assets/js/12.dc82eabe.js"><link rel="prefetch" href="/assets/js/13.045cf690.js"><link rel="prefetch" href="/assets/js/14.0643fd40.js"><link rel="prefetch" href="/assets/js/15.d618b027.js"><link rel="prefetch" href="/assets/js/16.e79fd5e7.js"><link rel="prefetch" href="/assets/js/17.dff49680.js"><link rel="prefetch" href="/assets/js/18.8bf3b222.js"><link rel="prefetch" href="/assets/js/19.b4020706.js"><link rel="prefetch" href="/assets/js/20.64d99ba4.js"><link rel="prefetch" href="/assets/js/21.ff317f26.js"><link rel="prefetch" href="/assets/js/22.c4062ec7.js"><link rel="prefetch" href="/assets/js/23.cc236a82.js"><link rel="prefetch" href="/assets/js/24.31f55451.js"><link rel="prefetch" href="/assets/js/25.5a02ab8e.js"><link rel="prefetch" href="/assets/js/26.9f4e234b.js"><link rel="prefetch" href="/assets/js/27.0b332c59.js"><link rel="prefetch" href="/assets/js/28.fb9e6fd5.js"><link rel="prefetch" href="/assets/js/29.c64fdafd.js"><link rel="prefetch" href="/assets/js/3.0692ab67.js"><link rel="prefetch" href="/assets/js/30.5b7dd487.js"><link rel="prefetch" href="/assets/js/31.acdbc643.js"><link rel="prefetch" href="/assets/js/32.84e04aee.js"><link rel="prefetch" href="/assets/js/33.50959bd8.js"><link rel="prefetch" href="/assets/js/34.3e76a850.js"><link rel="prefetch" href="/assets/js/35.a2fdb13a.js"><link rel="prefetch" href="/assets/js/36.5080c454.js"><link rel="prefetch" href="/assets/js/37.83741095.js"><link rel="prefetch" href="/assets/js/39.43445161.js"><link rel="prefetch" href="/assets/js/4.dbb40325.js"><link rel="prefetch" href="/assets/js/40.981db936.js"><link rel="prefetch" href="/assets/js/6.97497809.js"><link rel="prefetch" href="/assets/js/7.12ba85fa.js"><link rel="prefetch" href="/assets/js/8.e959cd54.js"><link rel="prefetch" href="/assets/js/9.48191f15.js">
    <link rel="stylesheet" href="/assets/css/0.styles.46b311ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-106e3130><div data-v-106e3130><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-106e3130 data-v-106e3130><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4d3be7b7 data-v-106e3130 data-v-106e3130><h3 class="title" style="display:none;" data-v-4d3be7b7 data-v-4d3be7b7>周清冽</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-4d3be7b7 data-v-4d3be7b7><input type="password" value="" data-v-4d3be7b7> <span data-v-4d3be7b7>Konck! Knock!</span> <button data-v-4d3be7b7>OK</button></label> <div class="footer" style="display:none;" data-v-4d3be7b7 data-v-4d3be7b7><span data-v-4d3be7b7><i class="iconfont reco-theme" data-v-4d3be7b7></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4d3be7b7>vuePress-theme-reco</a></span> <span data-v-4d3be7b7><i class="iconfont reco-copyright" data-v-4d3be7b7></i> <a data-v-4d3be7b7><span data-v-4d3be7b7>周清冽</span>
            
          <!---->
          2023
        </a></span></div></div> <div class="hide" data-v-106e3130><div data-v-106e3130><div id="smart" class="wrapper-page" style="background-image:url(https://img1.imgtp.com/2023/05/26/R6yXlG2T.jpg);background-position-x:center;background-position-y:center;background-size:cover;background-repeat-x:no-repeat;background-repeat-y:no-repeat;" data-v-106e3130><header class="navbar" data-v-106e3130><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.png" alt="周清冽" class="logo"> <span class="site-name">周清冽</span></a> <div class="links"><div id="dayNightSwitch" class="generalWrapper" data-v-68728e36><a class="click" data-v-68728e36><div class="onOff daySwitch" data-v-68728e36><div class="star star1" data-v-68728e36></div> <div class="star star2" data-v-68728e36></div> <div class="star star3" data-v-68728e36></div> <div class="star star4" data-v-68728e36></div> <div class="star star5" data-v-68728e36></div> <div class="star sky" data-v-68728e36></div> <div class="sunMoon" data-v-68728e36><div class="crater crater1" data-v-68728e36></div> <div class="crater crater2" data-v-68728e36></div> <div class="crater crater3" data-v-68728e36></div> <div class="cloud part1" data-v-68728e36></div> <div class="cloud part2" data-v-68728e36></div></div></div></a></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/技术笔记/" class="nav-link"><i class="iconfont undefined"></i>
  技术笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/树洞/" class="nav-link"><i class="iconfont undefined"></i>
  树洞
</a></li><li class="dropdown-item"><!----> <a href="/categories/神经网络/" class="nav-link"><i class="iconfont undefined"></i>
  神经网络
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-106e3130></div> <aside class="sidebar" data-v-106e3130><div class="personal-info-wrapper" data-v-d528efe2 data-v-106e3130><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-d528efe2> <h3 class="name" data-v-d528efe2>
    周清冽
  </h3> <div class="num" data-v-d528efe2><div data-v-d528efe2><h3 data-v-d528efe2>27</h3> <h6 data-v-d528efe2>文章</h6></div> <div data-v-d528efe2><h3 data-v-d528efe2>6</h3> <h6 data-v-d528efe2>标签</h6></div></div> <hr data-v-d528efe2></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/技术笔记/" class="nav-link"><i class="iconfont undefined"></i>
  技术笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/树洞/" class="nav-link"><i class="iconfont undefined"></i>
  树洞
</a></li><li class="dropdown-item"><!----> <a href="/categories/神经网络/" class="nav-link"><i class="iconfont undefined"></i>
  神经网络
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4d3be7b7 data-v-106e3130><h3 class="title" style="display:none;" data-v-4d3be7b7 data-v-4d3be7b7>TensorFlow笔记（11）</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-4d3be7b7 data-v-4d3be7b7><input type="password" value="" data-v-4d3be7b7> <span data-v-4d3be7b7>Konck! Knock!</span> <button data-v-4d3be7b7>OK</button></label> <div class="footer" style="display:none;" data-v-4d3be7b7 data-v-4d3be7b7><span data-v-4d3be7b7><i class="iconfont reco-theme" data-v-4d3be7b7></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4d3be7b7>vuePress-theme-reco</a></span> <span data-v-4d3be7b7><i class="iconfont reco-copyright" data-v-4d3be7b7></i> <a data-v-4d3be7b7><span data-v-4d3be7b7>周清冽</span>
            
          <!---->
          2023
        </a></span></div></div></div> <div data-v-106e3130><main class="page" style="padding-right:0;"><div class="page-title" style="display:none;"><h1 class="title">TensorFlow笔记（11）</h1> <div class="page-info" data-v-04a855f8><i class="iconfont reco-account" data-v-04a855f8><span data-v-04a855f8>周清冽</span></i> <i class="iconfont reco-date" data-v-04a855f8><span data-v-04a855f8>2022-12-04</span></i> <i class="iconfont reco-eye" data-v-04a855f8><span id="/blogs/tensor/ten11.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-04a855f8><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-04a855f8><span class="tag-item" data-v-04a855f8>tensorflow</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p>常见文件类型及加载方式<br></p></div> <p>神经网络的训练常常需要大量的数据，导入数据是神经网络能够开始训练的第一步。对于不同的文件类型，有不同的加载方式。本篇笔记主要记录了常见的几种文件的加载，附上代码注释以及自己暂时未能想通的的一些疑问，希望等再次回头看的时候会茅塞顿开。</p> <h2 id="_1、加载numpy类型数据-npz"><a href="#_1、加载numpy类型数据-npz" class="header-anchor">#</a> 1、加载numpy类型数据（.npz）</h2> <p>numpy数据以.npz的形式存储，在模型训练的过程中，最重要的一步就是要把数据集导入到神经网络。在TensorFlow中，必须使用不同的函数去加载不同的数据类型，.npz文件用的是numpy库的np.load()函数。而tf.data.Dataset.from_tensor_slice（）函数是将数据加载为特征和标签一一对应的数据。</p> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

DATA_URL<span class="token operator">=</span><span class="token string">'https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz'</span>
path<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">'mnist.npz'</span><span class="token punctuation">,</span>DATA_URL<span class="token punctuation">)</span>
<span class="token comment"># 从URL获取指定文件并获得其路径</span>

<span class="token keyword">with</span> np<span class="token punctuation">.</span>load<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> data<span class="token punctuation">:</span>
    train_examples<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'x_train'</span><span class="token punctuation">]</span>
    train_labels<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'y_train'</span><span class="token punctuation">]</span>
    test_examples<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'x_test'</span><span class="token punctuation">]</span>
    test_labels<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'y_test'</span><span class="token punctuation">]</span>
    <span class="token keyword">pass</span>
<span class="token comment"># with 上下文管理器 打开后关闭</span>
<span class="token comment"># np,load加载.npz类型文件，打开后以data命名</span>

train_dataset<span class="token operator">=</span>tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">.</span>from_tensor_slices<span class="token punctuation">(</span><span class="token punctuation">(</span>train_examples<span class="token punctuation">,</span>train_labels<span class="token punctuation">)</span><span class="token punctuation">)</span>
test_dataset<span class="token operator">=</span>tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">.</span>from_tensor_slices<span class="token punctuation">(</span><span class="token punctuation">(</span>test_examples<span class="token punctuation">,</span>test_labels<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 数据加载完成后，利用from_tensor_slice()函数将特征和标签一一对应</span>

BATCH_SIZE<span class="token operator">=</span><span class="token number">64</span>
SHUFFLE_BUFFER_SIZE<span class="token operator">=</span><span class="token number">100</span>
train_dataset<span class="token operator">=</span>train_dataset<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>SHUFFLE_BUFFER_SIZE<span class="token punctuation">)</span><span class="token punctuation">.</span>batch<span class="token punctuation">(</span>BATCH_SIZE<span class="token punctuation">)</span>
test_dataset<span class="token operator">=</span>test_dataset<span class="token punctuation">.</span>batch<span class="token punctuation">(</span>BATCH_SIZE<span class="token punctuation">)</span>
<span class="token comment"># 将训练数据集以每组100个打乱，然后分为64个一个batch</span>

model<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span>input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 限制输入层的结构</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token comment"># 输出的可能结果</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
    optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
    loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sparse_categorical_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_dataset<span class="token punctuation">,</span>epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_dataset<span class="token punctuation">)</span>
</code></pre></div><h2 id="_2、加载-csv文件"><a href="#_2、加载-csv文件" class="header-anchor">#</a> 2、加载.CSV文件</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> functools
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

TRAIN_DATA_URL <span class="token operator">=</span> <span class="token string">&quot;https://storage.googleapis.com/tf-datasets/titanic/train.csv&quot;</span>
TEST_DATA_URL <span class="token operator">=</span> <span class="token string">&quot;https://storage.googleapis.com/tf-datasets/titanic/eval.csv&quot;</span>
<span class="token comment"># 获取文件的路径地址</span>

train_file_path <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">&quot;train.csv&quot;</span><span class="token punctuation">,</span> TRAIN_DATA_URL<span class="token punctuation">)</span>
test_file_path <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">&quot;eval.csv&quot;</span><span class="token punctuation">,</span> TEST_DATA_URL<span class="token punctuation">)</span>
<span class="token comment"># 根据文件地址下载文件并保存为对应的文件名</span>

<span class="token comment"># 让 numpy 数据更易读。</span>
np<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> suppress<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># precission 表示数字精度   suppress  表示小数不需要用科学计数法输出</span>
df<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>train_file_path<span class="token punctuation">)</span>

<span class="token comment"># 显示所有行(参数设置为None代表显示所有行，也可以自行设置数字)</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment"># 显示所有列</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_rows'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment"># 设置数据的显示长度，默认为50</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'max_colwidth'</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
<span class="token comment"># 禁止自动换行(设置为Flase不自动换行，True反之)</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'expand_frame_repr'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># 打印csv文件的前几行，查看数据是否正确（默认为十行）</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># print(pathlib.Path(train_file_path))</span>

<span class="token comment"># CSV 文件的每列都会有一个列名。dataset 的构造函数会自动识别这些列名。如果文件的第一行不包含列名</span>
<span class="token comment"># 那么需要将列名通过字符串列表传给 make_csv_dataset 函数的 column_names 参数</span>
<span class="token comment"># CSV_COLUMN_NAMES = [&quot;survived&quot;, &quot;sex&quot;, &quot;age&quot;, &quot;n_siblings_spouses&quot;, &quot;parch&quot;, &quot;fare&quot;, &quot;class&quot;, &quot;deck&quot;, &quot;embark_town&quot;,</span>
<span class="token comment">#                     &quot;alone&quot;]</span>
<span class="token comment"># dataset = tf.data.experimental.make_cvs_dataset(...,column_names=CSV_COLUMN_NAMES,...）</span>
<span class="token comment"># 如果我们要有选择地加载csv文件中地某些列作为训练地属性，</span>
<span class="token comment"># 可以使用make_cvs_dataset函数中地select_columns参数进行指定</span>
<span class="token comment"># dataset = tf.data.experimental.make_csv_dataset(</span>
<span class="token comment">#   select_columns = &quot;要选择的列名称&quot;)</span>
<span class="token comment"># 如果cvs文件列中包含我们预测地类别属性，需要使用make_cvs_dataset函数中地label_name进行指定，代码同上</span>

LABEL_COLUMN <span class="token operator">=</span> <span class="token string">&quot;survived&quot;</span>
LABELS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token comment"># 设置参数，标签表示状态</span>

<span class="token keyword">def</span> <span class="token function">get_dataset</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dataset <span class="token operator">=</span> tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>make_csv_dataset<span class="token punctuation">(</span>train_file_path<span class="token punctuation">,</span>
                                                    <span class="token comment"># 读取的文件路径</span>
                                                    batch_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
                                                    <span class="token comment"># 一次读取的大小</span>
                                                    label_name<span class="token operator">=</span>LABEL_COLUMN<span class="token punctuation">,</span>
                                                    <span class="token comment"># 选择与标签名字对应的列</span>
                                                    na_value<span class="token operator">=</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">,</span>
                                                    <span class="token comment"># 表示缺失值用？表示</span>
                                                    num_epochs<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                                                    <span class="token comment"># 指定此数据集重复次数的 int。如果没有，则永远循环遍历数据集</span>
                                                    ignore_errors<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                                    <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> dataset
<span class="token comment">#定义了一个函数加载CSV中的数据，每次读取5个，只重复一次</span>

train_dataset <span class="token operator">=</span> get_dataset<span class="token punctuation">(</span>train_file_path<span class="token punctuation">)</span>
<span class="token comment"># 利用get_dataset函数获取数据</span>
test_dataset <span class="token operator">=</span> get_dataset<span class="token punctuation">(</span>test_file_path<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">show_batch</span><span class="token punctuation">(</span>dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">for</span> batch<span class="token punctuation">,</span> label <span class="token keyword">in</span> dataset<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> batch<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{:20s}: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

show<span class="token operator">=</span>show_batch<span class="token punctuation">(</span>train_dataset<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>show<span class="token punctuation">)</span>
<span class="token comment"># 打印一个batch的内容</span>

CATEGORIES <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'male'</span><span class="token punctuation">,</span> <span class="token string">'female'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'class'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'First'</span><span class="token punctuation">,</span> <span class="token string">'Second'</span><span class="token punctuation">,</span> <span class="token string">'Third'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'deck'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'J'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'embark_town'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Cherbourg'</span><span class="token punctuation">,</span> <span class="token string">'Southhampton'</span><span class="token punctuation">,</span> <span class="token string">'Queenstown'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'alone'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment"># 类别信息</span>
categorical_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> feature<span class="token punctuation">,</span> vocab <span class="token keyword">in</span> CATEGORIES<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cat_col <span class="token operator">=</span> tf<span class="token punctuation">.</span>feature_column<span class="token punctuation">.</span>categorical_column_with_vocabulary_list<span class="token punctuation">(</span>
        key<span class="token operator">=</span>feature<span class="token punctuation">,</span> vocabulary_list<span class="token operator">=</span>vocab<span class="token punctuation">)</span>
    categorical_columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>feature_column<span class="token punctuation">.</span>indicator_column<span class="token punctuation">(</span>cat_col<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>categorical_columns<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">process_continuous_data</span><span class="token punctuation">(</span>mean<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># 标准化数据</span>
  data <span class="token operator">=</span> tf<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>data<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>mean<span class="token punctuation">)</span>
  <span class="token comment"># 强制转换数据</span>
  <span class="token keyword">return</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


MEANS <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">29.631308</span><span class="token punctuation">,</span>
    <span class="token string">'n_siblings_spouses'</span><span class="token punctuation">:</span> <span class="token number">0.545455</span><span class="token punctuation">,</span>
    <span class="token string">'parch'</span><span class="token punctuation">:</span> <span class="token number">0.379585</span><span class="token punctuation">,</span>
    <span class="token string">'fare'</span><span class="token punctuation">:</span> <span class="token number">34.385399</span>
<span class="token punctuation">}</span>

numerical_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> feature <span class="token keyword">in</span> MEANS<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    num_col <span class="token operator">=</span> tf<span class="token punctuation">.</span>feature_column<span class="token punctuation">.</span>numeric_column<span class="token punctuation">(</span>feature<span class="token punctuation">,</span>
                                               normalizer_fn<span class="token operator">=</span>functools<span class="token punctuation">.</span>partial<span class="token punctuation">(</span>process_continuous_data<span class="token punctuation">,</span> MEANS<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    numerical_columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num_col<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>numerical_columns<span class="token punctuation">)</span>

preprocessing_layer <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>DenseFeatures<span class="token punctuation">(</span>categorical_columns<span class="token operator">+</span>numerical_columns<span class="token punctuation">)</span>
<span class="token comment"># 预处理层，基于给定 feature_columns 生成密集 Tensor 的层。两个列相加生成一个新对象，后一个列直接附在前一个列的后边</span>
model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
    preprocessing_layer<span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 输出神经元只有一个，0或者1</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
    loss<span class="token operator">=</span><span class="token string">'binary_crossentropy'</span><span class="token punctuation">,</span>
    <span class="token comment"># 二分类交叉熵函数</span>
    optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
    <span class="token comment"># 优化器</span>
    metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 评价标准</span>

train_data <span class="token operator">=</span> train_dataset<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
<span class="token comment"># 将训练数据打乱</span>
test_data <span class="token operator">=</span> test_dataset

model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_data<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment"># 输入训练集，训练神经网络，循环20次</span>

test_loss<span class="token punctuation">,</span> test_accuracy <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
<span class="token comment"># evaluate函数，输入数据和标签，输出损失值和选定的指标，并直接赋给test_loss, test_accuracy</span>
<span class="token comment"># 返回了多少个值，是不固定的，如果在complie的时候没有指定metrics的话，默认只有loss一个返回值。</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n\nTest Loss {}, Test Accuracy {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>test_loss<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">)</span><span class="token punctuation">)</span>

predictions <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
<span class="token comment"># predict函数是输入测试数据，输出测试结果</span>
<span class="token comment"># 显示部分结果</span>
<span class="token keyword">for</span> prediction<span class="token punctuation">,</span> survived <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>predictions<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>test_data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Predicted survival: {:.2%}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prediction<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">&quot; | Actual outcome: &quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">(</span><span class="token string">&quot;SURVIVED&quot;</span> <span class="token keyword">if</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>survived<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">&quot;DIED&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="_3、加载dataframe数据-csv"><a href="#_3、加载dataframe数据-csv" class="header-anchor">#</a> 3、加载Dataframe数据(.csv)</h2> <p>Dataframe（数据帧），是一个二位的数组格式，以CSV文件的形式存储。本部分引入的代码案例是根据不同人的各种身体条件判断是否患有心脏病的。在导入的CSV数据中，一共有13个不同的特征，而在搭建神经网络时输入层只有10个神经元，对于此部分难以理解。提出两个想法：①数据的13个特征并没有全部使用，而是某一步的代码有某些功能而自己并没有理解；②自己并没有搞清楚输入层的网络结构。针对想法②，针对Sequential搭建的网络结构，第一个数据表达的就是神经元个数。那么只有针对想法①展开，在注释过所有的代码后，暂时没有发现具体哪一步对特征数据进行了筛选。希望能在后续的学习中理解此部分内容，也欢迎读者指正。</p> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>   <span class="token comment"># 显示完整的列</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_rows'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># 显示完整的行</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.expand_frame_repr'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># 设置不折叠数据</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_colwidth'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>

csv_file<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">'heart.csv'</span><span class="token punctuation">,</span><span class="token string">'https://storage.googleapis.com/download.tensorflow.org/data/heart.csv'</span><span class="token punctuation">)</span>

df<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>csv_file<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'thal'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>Categorical<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'thal'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 将thal列（数据帧（dataframe）中的object）转换为离散数值</span>
df<span class="token punctuation">[</span><span class="token string">'thal'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">.</span>thal<span class="token punctuation">.</span>cat<span class="token punctuation">.</span>codes
<span class="token comment"># cat.codes 分类的编码，用数字表示分类数据</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

target<span class="token operator">=</span>df<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">)</span>
dataset<span class="token operator">=</span>tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">.</span>from_tensor_slices<span class="token punctuation">(</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>values<span class="token punctuation">,</span>target<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 切片，使特征和标签数据一一对应</span>
<span class="token keyword">for</span> feat<span class="token punctuation">,</span>targ <span class="token keyword">in</span> dataset<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Features: {}, Target: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>feat<span class="token punctuation">,</span> targ<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 打印前五行，查看数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'thal'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># constant 创建一个常量张量，查看thal的内容</span>
train_dataset<span class="token operator">=</span>dataset<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>batch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># len函数表示获取df数据的长度，然后shuffle一次性打乱所有的数据，再将数据分为一个数据一个batch</span>
<span class="token keyword">def</span> <span class="token function">create_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    model<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
        tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
        optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
        loss<span class="token operator">=</span><span class="token string">'binary_crossentropy'</span><span class="token punctuation">,</span>
        <span class="token comment"># 二进制交叉熵损失函数</span>
        metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span>
        <span class="token comment"># 评价标准</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> model

model<span class="token operator">=</span>create_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
history<span class="token operator">=</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_dataset<span class="token punctuation">,</span>epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="_4、tfrecord和tf-example"><a href="#_4、tfrecord和tf-example" class="header-anchor">#</a> 4、TFRecord和tf.Example</h2> <p>为了高效的读取数据，常用的方法是对数据进行序列化并将其存储在一组可线性读取的文件中。这非常适合通过网络进行流式传输的数据。</p> <p>TFRecord 格式是一种用于存储二进制记录序列的简单格式。</p> <p>协议缓冲区是一个跨平台、跨语言的库，用于高效地序列化结构化数据。</p> <p>协议消息由 .proto 文件定义，这通常是了解消息类型最简单的方法。</p> <p>tf.Example 消息（或 protobuf）是一种灵活的消息类型，表示 {&quot;string&quot;: value} 映射。它专为 TensorFlow 而设计，并被用于 TFX 等高级 API。</p></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <!----></main> <!----></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/bgm/dbmy.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:80px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/bgm/dbmy.png" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/bgm/dbmy.png);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>东北民谣</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>毛不易</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/assets/js/app.d0fa7b20.js" defer></script><script src="/assets/js/5.3a253b5d.js" defer></script><script src="/assets/js/1.cc71daf5.js" defer></script><script src="/assets/js/38.cbe48101.js" defer></script>
  </body>
</html>
